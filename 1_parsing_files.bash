# Create GSM2136658 patient relationship
more acc.cgi\?acc\=GSE80762 |grep GSM -A1| \
perl -pe 's/.+geoaxema_recenter\)\"\>//g'| \
perl -pe 's/\<\/a\>\<\/td\>//g'| \
perl -pe 's/.+\"top\"\>//g'| \
perl -pe 's/\<\/td\>\n//g' | \
perl -pe 's/\n/\t/g' | \
perl -pe 's/\-\-/\n/g' | \
perl -pe 's/\tGSM/GSM/g' | \
perl -pe 's/Patient\s/Patient\_/g'| \
perl -pe 's/\,\sDay.+/\_Untreated/g'| \
perl -pe 's/\,\sCycle.+/\_Treated/g' > gsm_patient_table.txt

# Unzip IDATs
gunzip *idat.gz
ls -1 *idat|perl -pe 's/\_/\t/g'|cut -f1,2,3|sort|uniq > ../idat_table.txt

## R Code for matching GSM with proper labels ##
gsm = read.table("gsm_patient_table.txt")
idat = read.table("idat_table.txt")
colnames(gsm) = c('gsm','Sample_ID')
colnames(idat) = c('gsm','Sentrix_ID','Sentrix_Position')
merged = merge(gsm,idat,by="gsm")
write.csv(merged[,2:4],"NEJM_sample_sheet.csv",row.names=F)
########################################################################

# Rearrange IDAT files
# create dirs
#ls -1 *idat|perl -pe 's/\_/\t/g'|cut -f2|sort|uniq|perl -pe 's/^/mkdir idats\//g'
mkdir idats
mkdir idats/10006044056
mkdir idats/10006044153
mkdir idats/100973330084
mkdir idats/100973330086
mkdir idats/200107460005
mkdir idats/200107460060
mkdir idats/200109350031
mkdir idats/200109350045
mkdir idats/200109350059
mkdir idats/200109350069
mkdir idats/3998579038
mkdir idats/3998579039

# move and change names
#ls -1 *idat|awk -F"\_" '{print "mv "$1"_"$2"_"$3"_"$4" idats/"$2"/"$2"_"$3"_"$4}'
mv GSM2136636_200107460005_R02C01_Grn.idat idats/200107460005/200107460005_R02C01_Grn.idat
mv GSM2136636_200107460005_R02C01_Red.idat idats/200107460005/200107460005_R02C01_Red.idat
mv GSM2136637_200107460005_R01C01_Grn.idat idats/200107460005/200107460005_R01C01_Grn.idat
mv GSM2136637_200107460005_R01C01_Red.idat idats/200107460005/200107460005_R01C01_Red.idat
mv GSM2136638_100973330086_R02C01_Grn.idat idats/100973330086/100973330086_R02C01_Grn.idat
mv GSM2136638_100973330086_R02C01_Red.idat idats/100973330086/100973330086_R02C01_Red.idat
mv GSM2136639_100973330084_R01C01_Grn.idat idats/100973330084/100973330084_R01C01_Grn.idat
mv GSM2136639_100973330084_R01C01_Red.idat idats/100973330084/100973330084_R01C01_Red.idat
mv GSM2136640_3998579038_R06C02_Grn.idat idats/3998579038/3998579038_R06C02_Grn.idat
mv GSM2136640_3998579038_R06C02_Red.idat idats/3998579038/3998579038_R06C02_Red.idat
mv GSM2136641_3998579039_R02C02_Grn.idat idats/3998579039/3998579039_R02C02_Grn.idat
mv GSM2136641_3998579039_R02C02_Red.idat idats/3998579039/3998579039_R02C02_Red.idat
mv GSM2136642_10006044056_R05C01_Grn.idat idats/10006044056/10006044056_R05C01_Grn.idat
mv GSM2136642_10006044056_R05C01_Red.idat idats/10006044056/10006044056_R05C01_Red.idat
mv GSM2136643_10006044056_R04C01_Grn.idat idats/10006044056/10006044056_R04C01_Grn.idat
mv GSM2136643_10006044056_R04C01_Red.idat idats/10006044056/10006044056_R04C01_Red.idat
mv GSM2136644_10006044056_R05C02_Grn.idat idats/10006044056/10006044056_R05C02_Grn.idat
mv GSM2136644_10006044056_R05C02_Red.idat idats/10006044056/10006044056_R05C02_Red.idat
mv GSM2136645_10006044056_R04C02_Grn.idat idats/10006044056/10006044056_R04C02_Grn.idat
mv GSM2136645_10006044056_R04C02_Red.idat idats/10006044056/10006044056_R04C02_Red.idat
mv GSM2136646_3998579039_R03C02_Grn.idat idats/3998579039/3998579039_R03C02_Grn.idat
mv GSM2136646_3998579039_R03C02_Red.idat idats/3998579039/3998579039_R03C02_Red.idat
mv GSM2136647_3998579038_R02C02_Grn.idat idats/3998579038/3998579038_R02C02_Grn.idat
mv GSM2136647_3998579038_R02C02_Red.idat idats/3998579038/3998579038_R02C02_Red.idat
mv GSM2136648_10006044153_R02C01_Grn.idat idats/10006044153/10006044153_R02C01_Grn.idat
mv GSM2136648_10006044153_R02C01_Red.idat idats/10006044153/10006044153_R02C01_Red.idat
mv GSM2136649_10006044153_R01C01_Grn.idat idats/10006044153/10006044153_R01C01_Grn.idat
mv GSM2136649_10006044153_R01C01_Red.idat idats/10006044153/10006044153_R01C01_Red.idat
mv GSM2136650_10006044153_R05C01_Grn.idat idats/10006044153/10006044153_R05C01_Grn.idat
mv GSM2136650_10006044153_R05C01_Red.idat idats/10006044153/10006044153_R05C01_Red.idat
mv GSM2136651_10006044153_R04C01_Grn.idat idats/10006044153/10006044153_R04C01_Grn.idat
mv GSM2136651_10006044153_R04C01_Red.idat idats/10006044153/10006044153_R04C01_Red.idat
mv GSM2136652_100973330084_R03C01_Grn.idat idats/100973330084/100973330084_R03C01_Grn.idat
mv GSM2136652_100973330084_R03C01_Red.idat idats/100973330084/100973330084_R03C01_Red.idat
mv GSM2136653_100973330084_R02C01_Grn.idat idats/100973330084/100973330084_R02C01_Grn.idat
mv GSM2136653_100973330084_R02C01_Red.idat idats/100973330084/100973330084_R02C01_Red.idat
mv GSM2136654_10006044153_R02C02_Grn.idat idats/10006044153/10006044153_R02C02_Grn.idat
mv GSM2136654_10006044153_R02C02_Red.idat idats/10006044153/10006044153_R02C02_Red.idat
mv GSM2136655_10006044153_R01C02_Grn.idat idats/10006044153/10006044153_R01C02_Grn.idat
mv GSM2136655_10006044153_R01C02_Red.idat idats/10006044153/10006044153_R01C02_Red.idat
mv GSM2136656_3998579038_R06C01_Grn.idat idats/3998579038/3998579038_R06C01_Grn.idat
mv GSM2136656_3998579038_R06C01_Red.idat idats/3998579038/3998579038_R06C01_Red.idat
mv GSM2136657_3998579038_R01C01_Grn.idat idats/3998579038/3998579038_R01C01_Grn.idat
mv GSM2136657_3998579038_R01C01_Red.idat idats/3998579038/3998579038_R01C01_Red.idat
mv GSM2136658_3998579038_R05C02_Grn.idat idats/3998579038/3998579038_R05C02_Grn.idat
mv GSM2136658_3998579038_R05C02_Red.idat idats/3998579038/3998579038_R05C02_Red.idat
mv GSM2136659_3998579039_R04C01_Grn.idat idats/3998579039/3998579039_R04C01_Grn.idat
mv GSM2136659_3998579039_R04C01_Red.idat idats/3998579039/3998579039_R04C01_Red.idat
mv GSM2136663_3998579039_R04C02_Grn.idat idats/3998579039/3998579039_R04C02_Grn.idat
mv GSM2136663_3998579039_R04C02_Red.idat idats/3998579039/3998579039_R04C02_Red.idat
mv GSM2136665_3998579039_R06C01_Grn.idat idats/3998579039/3998579039_R06C01_Grn.idat
mv GSM2136665_3998579039_R06C01_Red.idat idats/3998579039/3998579039_R06C01_Red.idat
mv GSM2136666_10006044153_R04C02_Grn.idat idats/10006044153/10006044153_R04C02_Grn.idat
mv GSM2136666_10006044153_R04C02_Red.idat idats/10006044153/10006044153_R04C02_Red.idat
mv GSM2136667_10006044153_R03C02_Grn.idat idats/10006044153/10006044153_R03C02_Grn.idat
mv GSM2136667_10006044153_R03C02_Red.idat idats/10006044153/10006044153_R03C02_Red.idat
mv GSM2136668_3998579039_R01C02_Grn.idat idats/3998579039/3998579039_R01C02_Grn.idat
mv GSM2136668_3998579039_R01C02_Red.idat idats/3998579039/3998579039_R01C02_Red.idat
mv GSM2136669_3998579038_R03C01_Grn.idat idats/3998579038/3998579038_R03C01_Grn.idat
mv GSM2136669_3998579038_R03C01_Red.idat idats/3998579038/3998579038_R03C01_Red.idat
mv GSM2136670_200107460005_R01C02_Grn.idat idats/200107460005/200107460005_R01C02_Grn.idat
mv GSM2136670_200107460005_R01C02_Red.idat idats/200107460005/200107460005_R01C02_Red.idat
mv GSM2136671_200107460005_R06C01_Grn.idat idats/200107460005/200107460005_R06C01_Grn.idat
mv GSM2136671_200107460005_R06C01_Red.idat idats/200107460005/200107460005_R06C01_Red.idat
mv GSM2136672_100973330086_R05C01_Grn.idat idats/100973330086/100973330086_R05C01_Grn.idat
mv GSM2136672_100973330086_R05C01_Red.idat idats/100973330086/100973330086_R05C01_Red.idat
mv GSM2136673_100973330086_R04C01_Grn.idat idats/100973330086/100973330086_R04C01_Grn.idat
mv GSM2136673_100973330086_R04C01_Red.idat idats/100973330086/100973330086_R04C01_Red.idat
mv GSM2136674_10006044153_R06C02_Grn.idat idats/10006044153/10006044153_R06C02_Grn.idat
mv GSM2136674_10006044153_R06C02_Red.idat idats/10006044153/10006044153_R06C02_Red.idat
mv GSM2136675_10006044153_R05C02_Grn.idat idats/10006044153/10006044153_R05C02_Grn.idat
mv GSM2136675_10006044153_R05C02_Red.idat idats/10006044153/10006044153_R05C02_Red.idat
mv GSM2136676_100973330086_R03C02_Grn.idat idats/100973330086/100973330086_R03C02_Grn.idat
mv GSM2136676_100973330086_R03C02_Red.idat idats/100973330086/100973330086_R03C02_Red.idat
mv GSM2136677_100973330086_R01C02_Grn.idat idats/100973330086/100973330086_R01C02_Grn.idat
mv GSM2136677_100973330086_R01C02_Red.idat idats/100973330086/100973330086_R01C02_Red.idat
mv GSM2136678_200107460005_R04C02_Grn.idat idats/200107460005/200107460005_R04C02_Grn.idat
mv GSM2136678_200107460005_R04C02_Red.idat idats/200107460005/200107460005_R04C02_Red.idat
mv GSM2136679_200107460005_R03C02_Grn.idat idats/200107460005/200107460005_R03C02_Grn.idat
mv GSM2136679_200107460005_R03C02_Red.idat idats/200107460005/200107460005_R03C02_Red.idat
mv GSM2136680_3998579039_R05C01_Grn.idat idats/3998579039/3998579039_R05C01_Grn.idat
mv GSM2136680_3998579039_R05C01_Red.idat idats/3998579039/3998579039_R05C01_Red.idat
mv GSM2136681_3998579038_R03C02_Grn.idat idats/3998579038/3998579038_R03C02_Grn.idat
mv GSM2136681_3998579038_R03C02_Red.idat idats/3998579038/3998579038_R03C02_Red.idat
mv GSM2136682_100973330086_R05C02_Grn.idat idats/100973330086/100973330086_R05C02_Grn.idat
mv GSM2136682_100973330086_R05C02_Red.idat idats/100973330086/100973330086_R05C02_Red.idat
mv GSM2136683_100973330084_R04C02_Grn.idat idats/100973330084/100973330084_R04C02_Grn.idat
mv GSM2136683_100973330084_R04C02_Red.idat idats/100973330084/100973330084_R04C02_Red.idat
mv GSM2136684_200109350031_R02C01_Grn.idat idats/200109350031/200109350031_R02C01_Grn.idat
mv GSM2136684_200109350031_R02C01_Red.idat idats/200109350031/200109350031_R02C01_Red.idat
mv GSM2136685_200109350031_R01C01_Grn.idat idats/200109350031/200109350031_R01C01_Grn.idat
mv GSM2136685_200109350031_R01C01_Red.idat idats/200109350031/200109350031_R01C01_Red.idat
mv GSM2136686_200107460060_R04C01_Grn.idat idats/200107460060/200107460060_R04C01_Grn.idat
mv GSM2136686_200107460060_R04C01_Red.idat idats/200107460060/200107460060_R04C01_Red.idat
mv GSM2136687_200107460060_R03C01_Grn.idat idats/200107460060/200107460060_R03C01_Grn.idat
mv GSM2136687_200107460060_R03C01_Red.idat idats/200107460060/200107460060_R03C01_Red.idat
mv GSM2136688_100973330086_R06C02_Grn.idat idats/100973330086/100973330086_R06C02_Grn.idat
mv GSM2136688_100973330086_R06C02_Red.idat idats/100973330086/100973330086_R06C02_Red.idat
mv GSM2136689_100973330084_R05C02_Grn.idat idats/100973330084/100973330084_R05C02_Grn.idat
mv GSM2136689_100973330084_R05C02_Red.idat idats/100973330084/100973330084_R05C02_Red.idat
mv GSM2136690_200109350031_R05C01_Grn.idat idats/200109350031/200109350031_R05C01_Grn.idat
mv GSM2136690_200109350031_R05C01_Red.idat idats/200109350031/200109350031_R05C01_Red.idat
mv GSM2136691_200109350031_R04C01_Grn.idat idats/200109350031/200109350031_R04C01_Grn.idat
mv GSM2136691_200109350031_R04C01_Red.idat idats/200109350031/200109350031_R04C01_Red.idat
mv GSM2136692_200107460060_R05C02_Grn.idat idats/200107460060/200107460060_R05C02_Grn.idat
mv GSM2136692_200107460060_R05C02_Red.idat idats/200107460060/200107460060_R05C02_Red.idat
mv GSM2136693_200107460060_R04C02_Grn.idat idats/200107460060/200107460060_R04C02_Grn.idat
mv GSM2136693_200107460060_R04C02_Red.idat idats/200107460060/200107460060_R04C02_Red.idat
mv GSM2136694_200109350031_R02C02_Grn.idat idats/200109350031/200109350031_R02C02_Grn.idat
mv GSM2136694_200109350031_R02C02_Red.idat idats/200109350031/200109350031_R02C02_Red.idat
mv GSM2136695_200109350031_R01C02_Grn.idat idats/200109350031/200109350031_R01C02_Grn.idat
mv GSM2136695_200109350031_R01C02_Red.idat idats/200109350031/200109350031_R01C02_Red.idat
mv GSM2136696_200109350031_R05C02_Grn.idat idats/200109350031/200109350031_R05C02_Grn.idat
mv GSM2136696_200109350031_R05C02_Red.idat idats/200109350031/200109350031_R05C02_Red.idat
mv GSM2136697_200109350031_R04C02_Grn.idat idats/200109350031/200109350031_R04C02_Grn.idat
mv GSM2136697_200109350031_R04C02_Red.idat idats/200109350031/200109350031_R04C02_Red.idat
mv GSM2136698_200109350045_R02C01_Grn.idat idats/200109350045/200109350045_R02C01_Grn.idat
mv GSM2136698_200109350045_R02C01_Red.idat idats/200109350045/200109350045_R02C01_Red.idat
mv GSM2136699_200109350045_R01C01_Grn.idat idats/200109350045/200109350045_R01C01_Grn.idat
mv GSM2136699_200109350045_R01C01_Red.idat idats/200109350045/200109350045_R01C01_Red.idat
mv GSM2136700_200109350045_R05C01_Grn.idat idats/200109350045/200109350045_R05C01_Grn.idat
mv GSM2136700_200109350045_R05C01_Red.idat idats/200109350045/200109350045_R05C01_Red.idat
mv GSM2136701_200109350045_R04C01_Grn.idat idats/200109350045/200109350045_R04C01_Grn.idat
mv GSM2136701_200109350045_R04C01_Red.idat idats/200109350045/200109350045_R04C01_Red.idat
mv GSM2136702_200109350045_R02C02_Grn.idat idats/200109350045/200109350045_R02C02_Grn.idat
mv GSM2136702_200109350045_R02C02_Red.idat idats/200109350045/200109350045_R02C02_Red.idat
mv GSM2136703_200109350045_R01C02_Grn.idat idats/200109350045/200109350045_R01C02_Grn.idat
mv GSM2136703_200109350045_R01C02_Red.idat idats/200109350045/200109350045_R01C02_Red.idat
mv GSM2136704_200109350045_R05C02_Grn.idat idats/200109350045/200109350045_R05C02_Grn.idat
mv GSM2136704_200109350045_R05C02_Red.idat idats/200109350045/200109350045_R05C02_Red.idat
mv GSM2136705_200109350045_R04C02_Grn.idat idats/200109350045/200109350045_R04C02_Grn.idat
mv GSM2136705_200109350045_R04C02_Red.idat idats/200109350045/200109350045_R04C02_Red.idat
mv GSM2136706_200109350059_R02C01_Grn.idat idats/200109350059/200109350059_R02C01_Grn.idat
mv GSM2136706_200109350059_R02C01_Red.idat idats/200109350059/200109350059_R02C01_Red.idat
mv GSM2136707_200109350059_R01C01_Grn.idat idats/200109350059/200109350059_R01C01_Grn.idat
mv GSM2136707_200109350059_R01C01_Red.idat idats/200109350059/200109350059_R01C01_Red.idat
mv GSM2136708_200109350059_R05C01_Grn.idat idats/200109350059/200109350059_R05C01_Grn.idat
mv GSM2136708_200109350059_R05C01_Red.idat idats/200109350059/200109350059_R05C01_Red.idat
mv GSM2136709_200109350059_R04C01_Grn.idat idats/200109350059/200109350059_R04C01_Grn.idat
mv GSM2136709_200109350059_R04C01_Red.idat idats/200109350059/200109350059_R04C01_Red.idat
mv GSM2136710_200109350059_R02C02_Grn.idat idats/200109350059/200109350059_R02C02_Grn.idat
mv GSM2136710_200109350059_R02C02_Red.idat idats/200109350059/200109350059_R02C02_Red.idat
mv GSM2136711_200109350059_R01C02_Grn.idat idats/200109350059/200109350059_R01C02_Grn.idat
mv GSM2136711_200109350059_R01C02_Red.idat idats/200109350059/200109350059_R01C02_Red.idat
mv GSM2136712_200109350059_R05C02_Grn.idat idats/200109350059/200109350059_R05C02_Grn.idat
mv GSM2136712_200109350059_R05C02_Red.idat idats/200109350059/200109350059_R05C02_Red.idat
mv GSM2136713_200109350059_R04C02_Grn.idat idats/200109350059/200109350059_R04C02_Grn.idat
mv GSM2136713_200109350059_R04C02_Red.idat idats/200109350059/200109350059_R04C02_Red.idat
mv GSM2136714_200109350069_R02C01_Grn.idat idats/200109350069/200109350069_R02C01_Grn.idat
mv GSM2136714_200109350069_R02C01_Red.idat idats/200109350069/200109350069_R02C01_Red.idat
mv GSM2136715_200109350069_R01C01_Grn.idat idats/200109350069/200109350069_R01C01_Grn.idat
mv GSM2136715_200109350069_R01C01_Red.idat idats/200109350069/200109350069_R01C01_Red.idat
mv GSM2136716_200109350069_R05C01_Grn.idat idats/200109350069/200109350069_R05C01_Grn.idat
mv GSM2136716_200109350069_R05C01_Red.idat idats/200109350069/200109350069_R05C01_Red.idat
mv GSM2136717_200109350069_R04C01_Grn.idat idats/200109350069/200109350069_R04C01_Grn.idat
mv GSM2136717_200109350069_R04C01_Red.idat idats/200109350069/200109350069_R04C01_Red.idat
mv GSM2136718_200109350069_R02C02_Grn.idat idats/200109350069/200109350069_R02C02_Grn.idat
mv GSM2136718_200109350069_R02C02_Red.idat idats/200109350069/200109350069_R02C02_Red.idat
mv GSM2136719_200109350069_R01C02_Grn.idat idats/200109350069/200109350069_R01C02_Grn.idat
mv GSM2136719_200109350069_R01C02_Red.idat idats/200109350069/200109350069_R01C02_Red.idat
#############################################################################################################



